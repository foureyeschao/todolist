(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{178:function(n,e,o){"use strict";var r=o(8),t=o(59).every,i=o(49),s=o(25),c=i("every"),a=s("every");r({target:"Array",proto:!0,forced:!c||!a},{every:function(n){return t(this,n,arguments.length>1?arguments[1]:void 0)}})},179:function(n,e,o){var r=o(8),t=o(180);r({target:"Array",stat:!0,forced:!o(123)((function(n){Array.from(n)}))},{from:t})},180:function(n,e,o){"use strict";var r=o(58),t=o(60),i=o(122),s=o(120),c=o(20),a=o(80),l=o(121);n.exports=function(n){var e,o,u,_,d,m,p=t(n),g="function"==typeof this?this:Array,f=arguments.length,v=f>1?arguments[1]:void 0,y=void 0!==v,h=l(p),S=0;if(y&&(v=r(v,f>2?arguments[2]:void 0,2)),null==h||g==Array&&s(h))for(o=new g(e=c(p.length));e>S;S++)m=y?v(p[S],S):p[S],a(o,S,m);else for(d=(_=h.call(p)).next,o=new g;!(u=d.call(_)).done;S++)m=y?i(_,v,[u.value,S],!0):u.value,a(o,S,m);return o.length=S,o}},181:function(n,e,o){"use strict";var r=o(8),t=o(124).trim;r({target:"String",proto:!0,forced:o(182)("trim")},{trim:function(){return t(this)}})},182:function(n,e,o){var r=o(2),t=o(81);n.exports=function(n){return r((function(){return!!t[n]()||"​᠎"!="​᠎"[n]()||t[n].name!==n}))}},183:function(n,e,o){"use strict";o.r(e),o.d(e,"exit",(function(){return h})),o.d(e,"createHtml",(function(){return v}));o(56),o(57),o(79);var r='<div class="login fade">\n                      <div class="login__box">\n                        '.concat('<div class="login__signin">\n      <p class="login__signin__welcome">欢迎登陆PureTodo!</p>\n      <form class="login__signin__form form">\n        <div class="form-control">\n          <input\n            class="username login__signin__input"\n            name="username"\n            type="text"\n            placeholder="用户名"\n          />\n          <p></p>\n        </div>\n        <div class="form-control">\n          <input\n            class="password login__signin__input"\n            name="password"\n            type="password"\n            placeholder="密码"\n          />\n          <p></p>\n        </div>\n        <button class=\'login__signin__button\' type="submit">登录</button>\n      </form>\n      <div class="login__bottom">\n        <a class="login__exit login__signin__exit" href="# ">退出</a>\n        <span>|</span>\n        <a class="login__changeState" href="# ">注册新账号</a>\n      </div>\n    </div>',"\n                        ").concat('<div class="login__signup hidden">\n      <p class="login__signup__welcome">欢迎注册新账户!</p>\n      <form class="login__signup__form form">\n        <div class="form-control">\n          <input\n            class="username login__signup__input"\n            name="username"\n            type="text"\n            placeholder="用户名"\n          />\n          <p></p>\n        </div>\n        <div class="form-control">\n          <input\n            class="email login__signup__input"\n            name="email"\n            type="text"\n            placeholder="邮箱"\n          />\n          <p></p>\n        </div>\n        \n        <div class="form-control">\n          <input\n            class="password login__signup__input"\n            name="password"\n            type="password"\n            placeholder="密码"\n          />\n          <p></p>\n        </div>\n\n        <div class="form-control">\n          <input\n            class="confirmPassword login__signup__input"\n            name="confirmPassword"\n            type="password"\n            placeholder="确认密码"\n          />\n          <p></p>\n        </div>\n\n        <button class=\'login__signup__button\' type="submit">注册</button>\n      </form>\n      <div class="login__bottom">\n        <a class="login__exit login__signup__exit" href="# ">退出</a>\n        <span>|</span>\n        <a class="login__changeState" href="# ">返回登陆栏</a>\n      </div>\n    </div>',"\n                      </div>\n                    </div>"),t=(o(178),o(179),o(119),o(82)),i=o.n(t);o(181);function s(n,e){var o=n.parentElement;o.classList.contains("form-error")||(o.className="form-control form-error",o.querySelector("p").innerText=e)}function c(n){var e=n.parentElement;e.className="form-control",e.querySelector("p").innerText=""}function a(n){n.forEach((function(n){""===n.value.trim()?s(n,"".concat(n.placeholder,"不能为空")):c(n)}))}function l(n,e,o){var r=n.value.trim().length;r<e?s(n,"".concat(n.placeholder,"长度至少为").concat(e,"个字符")):r>o?s(n,"".concat(n.placeholder,"长度不超过").concat(o,"个字符")):c(n)}function u(n){/^[a-zA-Z]+[a-zA-Z0-9]*$/.test(n.value.trim())||s(n,"".concat(n.placeholder,"开头必须为字母，全称只能包含字母、数字"))}function _(n){/^([a-zA-Z0-9]+[a-zA-Z0-9~!@#$%^&*()_+-=])*$/.test(n.value.trim())||s(n,"".concat(n.placeholder,"开头必须为字母或数字，全称只能包含字母、数字、和常见字符"))}var d=o(108),m=o(117),p=o(47),g=function(n){var e=document.querySelector(".login__signin__form"),o=e.querySelector(".username"),r=e.querySelector(".password");n.preventDefault(),a([o,r]),l(o,3,10),l(r,6,25),u(o),_(r),function(n,e){var o=document.querySelector(".login__signin"),r=o.querySelectorAll(".form-control"),t=o.querySelector(".login__signin__welcome");Array.from(r).every((function(n){return!n.classList.contains("form-error")}))&&i.a.post(p.a.signinUrl,{username:n,password:e}).then((function(e){var o=e.data.token,r=Object(d.a)(n);localStorage.setItem("CouchDB-auth",o),localStorage.setItem("User-name",n),localStorage.setItem("DB-name",r),t.innerText="登录成功！",t.classList.remove("error"),h(),Object(m.a)(n,o),console.log("Sync success!")})).catch((function(n){t.innerText="用户名或密码错误！",t.classList.add("error"),console.log(n.response)}))}(o.value,r.value)};var f=function(n){var e,o,r=document.querySelector(".login__signup__form"),t=r.querySelector(".username"),d=r.querySelector(".password"),m=r.querySelector(".confirmPassword"),g=r.querySelector(".email");n.preventDefault(),a([t,d,m,g]),l(t,3,10),l(d,6,25),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test((e=g).value.trim())?c(e):s(e,"请输入正确的".concat(e.placeholder,"格式")),o=m,d.value!==o.value&&s(o,"两次输入的密码不一致"),u(t),_(d),function(n,e,o){var r=document.querySelector(".login__signup"),t=r.querySelectorAll(".form-control"),s=r.querySelector(".login__signup__welcome");Array.from(t).every((function(n){return!n.classList.contains("form-error")}))&&i.a.post(p.a.registerUrl,{username:n,password:e,email:o}).then((function(n){console.log(n.data)})).catch((function(n){s.innerText="用户名已存在！",s.classList.add("error"),console.log(n.response.data)}))}(t.value,d.value,g.value)};function v(){var n,e,o,t,i,s,c,a,l;document.body.insertAdjacentHTML("beforeend",r),n=document.querySelector(".login__signin"),e=document.querySelector(".login__signup"),o=document.querySelectorAll(".form-control"),t=document.querySelector(".login__signin__welcome"),o.forEach((function(n){var e=n.querySelector("input"),o=n.querySelector("p");e.value="",n.classList.remove("form-error"),o.innerText=""})),n.classList.remove("hidden"),e.classList.add("hidden"),t.innerText="欢迎登陆PureTodo!",t.classList.remove("error"),i=document.querySelector(".login__box"),s=document.querySelector(".login__signin__form"),c=document.querySelector(".login__signup__form"),a=document.querySelector(".login__signin__exit"),l=document.querySelector(".login__signup__exit"),s.addEventListener("submit",g),c.addEventListener("submit",f),i.addEventListener("click",y),a.addEventListener("click",h),l.addEventListener("click",h)}function y(n){var e=document.querySelector(".login__signin"),o=document.querySelector(".login__signup");n.target.classList.contains("login__changeState")&&(e.classList.toggle("hidden"),o.classList.toggle("hidden"))}function h(){document.querySelector(".login").remove()}}}]);