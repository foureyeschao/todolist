!function(e){function t(t){for(var o,s,c=t[0],l=t[1],u=t[2],d=t[3]||[],f=0,p=[];f<c.length;f++)s=c[f],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&p.push(a[s][0]),a[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(h&&h(t),r.push.apply(r,d);p.length;)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,l=1;l<n.length;l++){var u=n[l];0!==a[u]&&(o=!1)}o&&(i.splice(t--,1),e=c(c.s=n[0]))}return 0===i.length&&(r.forEach((function(e){if(void 0===a[e]){a[e]=null;var t=document.createElement("link");c.nc&&t.setAttribute("nonce",c.nc),t.rel="prefetch",t.as="script",t.href=s(e),document.head.appendChild(t)}})),r.length=0),e}var o={},a={6:0},i=[],r=[];function s(e){return c.p+""+({3:"delete-all-7c994651",5:"login-01e7b97c"}[e]||e)+"."+{3:"110cce322c37ae8c9380",5:"25d3618ef9875fb629ac"}[e]+".js"}function c(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,o){n=a[e]=[t,o]}));t.push(n[2]=o);var i,r=document.createElement("script");r.charset="utf-8",r.timeout=120,c.nc&&r.setAttribute("nonce",c.nc),r.src=s(e);var l=new Error;i=function(t){r.onerror=r.onload=null,clearTimeout(u);var n=a[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",l.name="ChunkLoadError",l.type=o,l.request=i,n[1](l)}a[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:r})}),12e4);r.onerror=r.onload=i,document.head.appendChild(r)}return Promise.all(t)},c.m=e,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="",c.oe=function(e){throw console.error(e),e};var l=window.webpackJsonp=window.webpackJsonp||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var h=u,f=(i.push([151,0,1,2]),n());t([[],{},0,[3,5]])}({0:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r}));var o,a=n(15);function i(){o=a.a}function r(){(o=a.b).deleteAllTasks()}var s={db:o=localStorage.getItem("DB-name")&&localStorage.getItem("CouchDB-auth")?a.a:a.b,addTask:function(e,t){o.addTask(e,t)},showTask:function(e,t){o.showTask(e,t)},searchTask:function(e){o.searchTask(e)},modifyTask:function(e,t,n){o.modifyTask(e,t,n)},showDetail:function(e){o.showDetail(e)},deleteAllTasks:function(){o.deleteAllTasks()}}},105:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(99),n(67),n(100);function o(e){return"userdb-".concat(function(e){e=unescape(encodeURIComponent(e));for(var t="",n=0;n<e.length;n++)t+=e.charCodeAt(n).toString(16);return t}(e))}},106:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return _}));var o,a=n(105),i=n(17),r=n(15),s=n(74),c=document.querySelector(".todolist__sync-state");var l=n(0);n(98);var u=function(){var e=localStorage.getItem("User-name");return'<div class="profile-popup fade">\n                      <b class="profile-popup__container">\n                        <span class="profile-popup__close close">X</span>\n                        <div class="profile-popup__content">\n                          <h2>你好，'.concat(e,'！</span></h2>\n                          <button class="profile-popup__btn profile-popup__btn--change-username button">修改用户名</button>\n                          <button class="profile-popup__btn profile-popup__btn--change-password button">修改密码</button>\n                          <button class="profile-popup__btn profile-popup__btn--logout button">登出</button>\n                        </divc>\n                      </div>\n                    </div>')},d=n(14);function h(){var e=document.querySelector(".site-header__login"),t=document.querySelector(".site-header__profile"),n=localStorage.getItem("User-name").slice(0,1).toUpperCase();t.firstElementChild.innerText=n,e.classList.add("hidden"),t.classList.remove("hidden"),t.addEventListener("click",f)}function f(){var e,t;document.body.insertAdjacentHTML("beforeend",u()),e=document.querySelector(".profile-popup__close"),t=document.querySelector(".profile-popup__btn--logout"),e.addEventListener("click",v),t.addEventListener("click",p)}function p(){var e;localStorage.removeItem("User-name"),localStorage.removeItem("DB-name"),localStorage.removeItem("CouchDB-auth"),e=document.querySelector(".site-header__login"),document.querySelector(".site-header__profile").classList.add("hidden"),e.classList.remove("hidden"),v(),o.cancel(),Object(l.c)(),d.a.freshPage()}function v(){var e=document.querySelector(".profile-popup");document.body.removeChild(e)}function m(e,t){h(),Object(l.b)(),function(e,t,n){var l=Object(a.a)(t),u=new i.a(s.c,{fetch:function(e,t){return t.headers.set("X-Auth-CouchDB-Token",n),t.headers.set("X-CouchDB-dbName",l),t.credentials="omit",i.a.fetch(e,t)},skip_setup:!0});o=i.a.sync(e,u,{live:!0,heartbeat:!1,timeout:!1,retry:!0}).on("active",(function(e){console.log(e),c.innerText="与云端硬盘同步数据中..."})).on("change",(function(e){console.log(e),r.a.showCurrentTask(),c.innerText="数据同步完成!"})).on("paused",(function(e){console.log(e)})).on("error",(function(e){console.log(e),localStorage.clear()}))}(r.a.db,e,t),r.a.showTask("taskType","work")}function _(){var e=localStorage.getItem("DB-name"),t=localStorage.getItem("CouchDB-auth"),n=localStorage.getItem("User-name");e&&t&&n?(!function(e){var t=localStorage.getItem("DB-name"),n=localStorage.getItem("CouchDB-auth"),a=new i.a(s.c,{fetch:function(e,o){return o.headers.set("X-Auth-CouchDB-Token",n),o.headers.set("X-CouchDB-dbName",t),o.credentials="omit",i.a.fetch(e,o)},skip_setup:!0});o=i.a.sync(e,a,{live:!0,heartbeat:!1,timeout:!1,retry:!0}).on("active",(function(e){console.log(e),c.innerText="与云端硬盘同步数据中..."})).on("change",(function(e){console.log(e),r.a.showCurrentTask(),c.innerText="数据同步完成!"})).on("paused",(function(e){console.log(e)})).on("error",(function(e){console.log(e),localStorage.clear()}))}(r.a.db),h(),l.a.showTask("taskType","work")):l.a.showTask("taskType","work")}},14:function(e,t,n){"use strict";var o=document.querySelector(".todolist__sync-state"),a=document.querySelector(".todolist__tasks"),i=document.querySelector(".detail__paragraph"),r=document.querySelector(".detail__title"),s={get_input_element:function(){return document.querySelector(".site-header__search-box__input")},get_level_element:function(){return document.querySelector(".icon__level")},inActColor:function(e){return e.classList.toggle("act-color")},toggleLevel:function(e,t,n){s.get_level_element().classList.remove(e),s.get_level_element().classList.add(t),s.get_level_element().setAttribute("level",n),s.get_input_element().focus()},freshPage:function(){o.innerText="",a.innerText="",r.innerText="",i.innerText=""}};t.a=s},15:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return g}));n(128),n(54),n(59),n(94),n(135),n(98),n(136),n(99),n(45),n(67),n(83),n(100),n(108),n(55),n(142);var o=n(17),a=n(107),i=n(14);n(78);function r(e){var t='<li id="things_'.concat(e._id,'" class="todolist__content ').concat(e.level,'" idnum="').concat(e._id,"\">\n                            <div>\n                              <span class='todolist__title' contenteditable='true' idnum=").concat(e._id,"> ").concat(e.title," </span>\n                            </div>\n                            <div class='icon__todo'>\n                              <svg class='icon icon__nofinish' aria-hidden='true' name='search' idnum=").concat(e._id,">\n                                <use class='icon__finish' xlink:href='#icon-eglass-finish1'></use>\n                                <use xlink:href='#icon-eglass-finish'></use>\n                              </svg>\n                              <svg class='icon icon__delete' aria-hidden='true' name='search' idnum=").concat(e._id,">\n                                <use xlink:href='#icon-delete'></use>\n                              </svg>\n                            </div>\n                          </li>");return document.createRange().createContextualFragment(t)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}o.a.plugin(a.a);var c=(new Date).toString(),l=i.a.get_input_element(),u=i.a.get_level_element(),d=document.querySelector(".todolist__tasks"),h=document.querySelector(".detail__paragraph"),f=document.querySelector(".detail__title"),p=new o.a("userDB"),v=new o.a("visitorDB"),m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.db=t}var t,n,o;return t=e,(n=[{key:"addTask",value:function(e,t){var n,o=l.value,a=u.getAttribute("level"),i=(new Date).toLocaleDateString(),r=document.querySelector(".sidebar__act").getAttribute("taskType"),s=c.slice.call(c,0,3).toUpperCase();n=arguments[0]?{_id:(new Date).toISOString(),title:e,level:t,taskTime:i,taskType:r,taskWeek:s,detail:null}:{_id:(new Date).toISOString(),title:o,level:a,taskTime:i,taskType:r,taskWeek:s,detail:null},this.db.put(n).then((function(){console.log("添加到数据库成功！")})).catch((function(e){console.log(e)}))}},{key:"showTask",value:function(e,t){var n=this;return this.db.createIndex({index:{fields:[e]}}).then((function(){return"taskType"===e?n.db.find({selector:{taskType:t},sort:[{taskType:"desc"}]}).then((function(e){n.redrawTasksUI(e.docs)})):n.db.find({selector:{level:t},sort:[{level:"desc"}]}).then((function(e){n.redrawTasksUI(e.docs)}))}))}},{key:"showCurrentTask",value:function(){var e=document.querySelector(".sidebar__act").getAttribute("taskType");this.showTask("taskType",e)}},{key:"redrawTasksUI",value:function(e){var t="",n=document.createElement("ul");n.classList.add("todolist__list"),e.forEach((function(e){if(t!==e.taskTime){t=e.taskTime;var o=function(e){var t=e.taskTime,n=e.taskWeek,o="<li class=\"todolist__time\">\n                            <span class='todolist__week'>".concat(n,"</span>\n                            <span class='todolist__date'>").concat(t,"</span>\n                          </li>");return document.createRange().createContextualFragment(o)}(e);n.appendChild(o)}var a=r(e);n.appendChild(a)})),d.innerHTML="",d.appendChild(n),n.firstChild?(n.firstChild.nextSibling.classList.add("todolist__focus"),this.showDetail(e[length]._id)):this.showDetail()}},{key:"searchTask",value:function(e){var t,n=this,o=document.createElement("ul");o.classList.add("todolist__list"),this.db.allDocs({include_docs:!0,descending:!0}).then((function(a){if(a.rows.forEach((function(a){if((a=a.doc).title&&-1!==a.title.indexOf(e)){t!==a.taskTime&&(t=a.taskTime,o.appendChild(n.createTimeStamp(a)));var i=r(a);o.appendChild(i)}})),d.innerHTML="",d.appendChild(o),o.firstChild){var i=o.firstChild.nextSibling;i.classList.add("todolist__focus"),n.showDetail(i.getAttribute("idnum"))}else n.showDetail()}))}},{key:"modifyTask",value:function(e,t,n){var o=this;this.db.get(e).then((function(e){e[t]=n,o.db.put(e)}))}},{key:"showDetail",value:function(e){e?this.db.get(e).then((function(e){var t=e.title,n=e.detail;f.innerText=t,h.value=n,h.placeholder="添加任务详情..."})):(f.innerText="",h.value="",h.placeholder="此分类目前没有任务哦~")}},{key:"deleteAllTasks",value:function(){var e=this;this.db.allDocs().then((function(t){return Promise.all(t.rows.map((function(t){return e.db.remove(t.id,t.value.rev)})))})).then((function(){i.a.freshPage()})).catch((function(e){console.log(e+"删除数据库失败！")}))}}])&&s(t.prototype,n),o&&s(t,o),e}(),_=new m(p),g=new m(v)},150:function(e,t,n){},151:function(e,t,n){"use strict";n.r(t);n(67),n(83),n(54),n(55);var o=n(0),a=[0,1,2];var i=document.querySelector(".site-header__loginButton"),r=document.querySelector(".site-header__loginIcon"),s=document.querySelector(".sidebar__content"),c=document.querySelector(".sidebar__delete"),l=document.querySelector(".todolist"),u=document.querySelector(".detail__paragraph");s.addEventListener("click",(function(e){var t=document.querySelectorAll(".sidebar__list-type"),n=e.target;if(n.classList.contains("sidebar__list-type")){t.forEach((function(e){e.classList.remove("sidebar__act")})),n.classList.add("sidebar__act");var i=n.getAttribute("taskType");o.a.showTask("taskType",i)}else if(n.classList.contains("sidebar__list-level")){a.push(a.shift());var r=n.children,s=r[a[0]],c=s.getAttribute("level");Array.prototype.forEach.call(r,(function(e){e.classList.remove("active")})),s.classList.add("active"),o.a.showTask("level",c)}})),l.addEventListener("focusout",(function(e){if("SPAN"===e.target.tagName.toUpperCase()){var t=e.target,n=t.getAttribute("idnum"),a=t.innerText;o.a.modifyTask(n,"title",a)}})),l.addEventListener("click",(function(e){var t=document.querySelector(".todolist__list"),n=document.querySelector(".todolist__focus");if(e.target.classList.contains("icon__nofinish")){var a=e.target.getAttribute("idnum");o.a.modifyTask(a,"taskType","finish");var i=e.target.parentNode.parentNode,r=i.previousSibling.classList.contains("todolist__content"),s=i.nextSibling;if((!r&&null==s||!r&&!s.classList.contains("todolist__content"))&&i.parentNode.removeChild(i.previousSibling),i.parentNode.removeChild(i),t.firstChild){if(i===n){var c=t.firstChild.nextSibling;c.classList.add("todolist__focus"),o.a.showDetail(c.getAttribute("idnum"))}}else o.a.showDetail()}})),l.addEventListener("click",(function(e){var t=document.querySelector(".todolist__list"),n=document.querySelector(".todolist__focus");if(e.target.classList.contains("icon__delete")){var a=e.target.getAttribute("idnum");o.a.modifyTask(a,"taskType","bin");var i=e.target.parentNode.parentNode,r=i.previousSibling.classList.contains("todolist__content"),s=i.nextSibling;if((!r&&null==s||!r&&!s.classList.contains("todolist__content"))&&i.parentNode.removeChild(i.previousSibling),i.parentNode.removeChild(i),t.firstChild){if(i===n){var c=t.firstChild.nextSibling;c.classList.add("todolist__focus"),o.a.showDetail(c.getAttribute("idnum"))}}else o.a.showDetail()}})),l.addEventListener("click",(function(e){if(e.target.classList.contains("todolist__content")){var t=e.target.parentNode.childNodes,n=e.target.getAttribute("idnum");t.forEach((function(e){e.classList.remove("todolist__focus")})),e.target.classList.add("todolist__focus"),o.a.showDetail(n)}})),u.addEventListener("focusout",(function(){var e=document.querySelector(".todolist__focus").getAttribute("idnum"),t=this.value;o.a.modifyTask(e,"detail",t)})),c.addEventListener("click",(function(){n.e(3).then(n.bind(null,184)).then((function(e){(0,e.createDeletePopup)()}))})),i.addEventListener("click",(function(){n.e(5).then(n.bind(null,183)).then((function(e){(0,e.createHtml)()}))})),r.addEventListener("click",(function(){n.e(5).then(n.bind(null,183)).then((function(e){(0,e.createHtml)()}))}));n(73),n(45),n(148);function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var h=document.querySelector(".site-header__random-task__fire"),f=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.randomTaskBtn=t,this.randomContent=n,this.randomLevel=o,this.event()}var t,n,a;return t=e,(n=[{key:"event",value:function(){this.randomTaskBtn.addEventListener("click",this.randomTask.bind(this))}},{key:"randomTask",value:function(){var e=parseInt(Math.random()*this.randomContent.length),t=parseInt(3*Math.random()),n=document.querySelector(".sidebar__act").getAttribute("taskType");o.a.addTask(this.randomContent[e],this.randomLevel[t]),o.a.showTask("taskType",n)}}])&&d(t.prototype,n),a&&d(t,a),e}();new f(h,["读完那本英文原著","中午去睡个好觉","日语入门学习","尝试做些家常菜","了解一些设计常识"],["bgc-light","bgc-usual","bgc-heavy"]);var p=n(14);function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var m=document.querySelector(".site-header__search-box__content"),_=document.querySelector(".icon__add"),g=p.a.get_input_element(),b=p.a.inActColor,k=function(){function e(t,n,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.searchBox=t,this.addBtn=n,this.input=o,this.inActColor=a,this.event()}var t,n,a;return t=e,(n=[{key:"event",value:function(){this.searchBox.addEventListener("click",this.openSearchTask.bind(this)),this.input.addEventListener("keyup",this.searchTask),this.input.addEventListener("keyup",this.addTask2.bind(this)),this.addBtn.addEventListener("click",this.addTask1.bind(this))}},{key:"openSearchTask",value:function(e){var t=document.querySelector(".sidebar__act").getAttribute("taskType");e.target.classList.contains("icon__search")&&(this.inActColor(e.target),this.inActColor(this.input),this.inActColor(this.searchBox),this.input.focus(),this.input.value="",this.input.classList.contains("act-color")||o.a.showTask("taskType",t))}},{key:"searchTask",value:function(e){e.target.classList.contains("act-color")&&o.a.searchTask(this.value)}},{key:"addTask1",value:function(){var e=document.querySelector(".sidebar__act").getAttribute("taskType");this.input.value&&(o.a.addTask(),o.a.showTask("taskType",e),this.input.value="")}},{key:"addTask2",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event,t=e.which||e.keyCode||e.charCode,n=document.querySelector(".sidebar__act").getAttribute("taskType");document.activeElement.value&&13==t&&"INPUT"===document.activeElement.tagName.toUpperCase()&&(o.a.addTask(),o.a.showTask("taskType",n),this.input.value="")}}])&&v(t.prototype,n),a&&v(t,a),e}();new k(m,_,g,b);function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var T=p.a.toggleLevel,w=p.a.get_level_element(),S={green:{dotPressed:function(){T("level-light","level-usual","bgc-usual"),this.state=S.purple}},purple:{dotPressed:function(){T("level-usual","level-heavy","bgc-heavy"),this.state=S.red}},red:{dotPressed:function(){T("level-heavy","level-light","bgc-light"),this.state=S.green}}},L=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=n,this.levelDot=t,this.event()}var t,n,o;return t=e,(n=[{key:"event",value:function(){var e=this;this.levelDot.addEventListener("click",(function(){e.state.dotPressed.call(e)}))}}])&&y(t.prototype,n),o&&y(t,o),e}();new L(w,S.green);function C(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var q=document.querySelector(".site-header"),A=document.querySelector(".site-header__theme-btn"),E=function(){function e(t,n,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.theme=t,this.themeIconName=n,this.siteHeader=o,this.themeBtn=a,this.event()}var t,n,o;return t=e,(n=[{key:"event",value:function(){this.themeBtn.addEventListener("click",this.changeTheme.bind(this))}},{key:"changeTheme",value:function(){var e=this.themeBtn.children[0].children[0];this.theme.push(this.theme.shift()),this.themeIconName.push(this.themeIconName.shift()),this.siteHeader.setAttribute("class","site-header "+this.theme[0]),e.setAttribute("xlink:href",this.themeIconName[0])}}])&&C(t.prototype,n),o&&C(t,o),e}();new E(["","theme-green","theme-purple","theme-gradual"],["#icon-theme","#icon-theme1","#icon-theme2","#icon-theme3"],q,A);n(150);var x=n(106);Object(x.b)()},74:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var o="http://192.168.206.143:4000",a="http://192.168.206.143:3000/api/user/login",i="http://192.168.206.143:3000/api/user/register"}});